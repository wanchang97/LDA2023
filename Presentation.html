<!DOCTYPE html>
<html lang="en"><head>
<script src="Presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="Presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="Presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="Presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Group2: Hugo Blain; Oscar Cabanelas;Wanchang Zhang">
  <title>Longitudinal Data Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="Presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Longitudinal Data Analysis</h1>
  <p class="subtitle">Case study of Trenal.XLS</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Group2: Hugo Blain; Oscar Cabanelas;Wanchang Zhang 
</div>
</div>
</div>

  <p class="date">3/31/23</p>
</section>

<section>
<section id="data-description" class="title-slide slide level1 center">
<h1>Data description</h1>
<div class="cell">

</div>
<div class="cell">

</div>
</section>
<section id="background" class="slide level2">
<h2>Background</h2>
<ul>
<li><p>The dataset <code>Trenal.XLS</code> contains information on patients who received renal graft(kidney transplant). The patients have been followed for at most 10 years.</p></li>
<li><p>People with end-stage kidney disease who receive a kidney transplant generally live longer than people with ESRD who are on dialysis.</p></li>
<li><p>However, kidney transplant recipients must remain on immunosuppressants (medications to suppress the immune system) for the rest of their life to prevent their body from rejecting the new kidney. The long-term immunosuppression puts them at risk for infections and cancer.</p></li>
<li><p>Haematocrit level is meassured for each patient who has received renal graft to see if gender, the age to go through the operation, reject or not, cardio history or not will influence the healthy state of a patient after operation.</p></li>
</ul>
</section>
<section id="data-organisation" class="slide level2 smaller">
<h2>Data organisation</h2>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 37%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Variables</strong></th>
<th style="text-align: left;"><strong>Physical Meaning</strong></th>
<th style="text-align: left;"><strong>Types of the variable</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">Identification Number of each subject</td>
<td style="text-align: left;">Categorical, ordinal <span class="math inline">\(1,2,3,\cdots,1160\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Hc</td>
<td style="text-align: left;">Haematocrit level (the percentage of red blood cells in the body)</td>
<td style="text-align: left;">Continuous units in <span class="math inline">\(\%\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hc0, Hc06, Hc1, Hc2,<span class="math inline">\(\cdots\)</span>, Hc10</td>
<td style="text-align: left;">Haematocrit level meassured at the moment of time <span class="math inline">\({0,0.5,1,2,\cdots,10}\)</span> years after the kidney transplant</td>
<td style="text-align: left;">Continuous; units in <span class="math inline">\(\%\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">Age of the patient when performing the kidney transplant</td>
<td style="text-align: left;">Continuous; from <span class="math inline">\(15\)</span> to <span class="math inline">\(76\)</span> years old, average is <span class="math inline">\(46.43\)</span> years old</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: left;">Gender</td>
<td style="text-align: left;">Binary: 0 = female ; 1 = male</td>
</tr>
<tr class="even">
<td style="text-align: left;">reject</td>
<td style="text-align: left;">Has the patient shown symptoms of graft rejection during the first three months after the transportation</td>
<td style="text-align: left;">Binary: 0 = no 1 = yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cardio</td>
<td style="text-align: left;">Has the patient experienced a cardio-vascular problem during the years preceding the transplantation</td>
<td style="text-align: left;">Binary: 0 = no 1 = yes</td>
</tr>
</tbody>
</table>
</section>
<section id="observations" class="slide level2">
<h2>Observations</h2>
<p>Our given data set is Longitudinal data with two levels: time-level and subject-level</p>
<p>+Time-level (also called Level One) variables: changed with time, indexed by <span class="math inline">\(j\)</span> e.g.&nbsp;time and response Hc +Subject-level* (also called Level Two) variables: changed with subjects indexed by <span class="math inline">\(i\)</span> e.g.&nbsp;age, male, reject, cardio</p>
</section>
<section id="missing-data-distribution" class="slide level2">
<h2>Missing data distribution</h2>
<div class="cell" data-layout-align="center" data-fig.axis="1">
<div class="cell-output-display">
<table style="width:100%;">
<caption>Missing data for each measurement</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">HC0</th>
<th style="text-align: right;">HC06</th>
<th style="text-align: right;">HC1</th>
<th style="text-align: right;">HC2</th>
<th style="text-align: right;">HC3</th>
<th style="text-align: right;">HC4</th>
<th style="text-align: right;">HC5</th>
<th style="text-align: right;">HC6</th>
<th style="text-align: right;">HC7</th>
<th style="text-align: right;">HC8</th>
<th style="text-align: right;">HC9</th>
<th style="text-align: right;">HC10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hc.NA</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">87.000</td>
<td style="text-align: right;">205.000</td>
<td style="text-align: right;">314.000</td>
<td style="text-align: right;">418.00</td>
<td style="text-align: right;">508.000</td>
<td style="text-align: right;">595.000</td>
<td style="text-align: right;">672.000</td>
<td style="text-align: right;">749.000</td>
<td style="text-align: right;">812.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hc.NA.percentage</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.646</td>
<td style="text-align: right;">0.7</td>
</tr>
</tbody>
</table>
</div>

</div>
<img data-src="Presentation_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="missing-data-distribution-1" class="slide level2 smaller">
<h2>Missing data distribution</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>First we extract a data with the Hc level is missing (shown as NA) as a new data frame <code>trenal.long.NA.unique</code></li>
<li>Then We plot the histogram of all the predictors: age, male, cardio and reject (the 4 columns corresponding to the right figure).on both the original data set <code>trenal.long.unique</code> and the missing data frame <code>trenal.long.NA.unique</code></li>
<li>We may conclude that missing data are random and has no specific preference on any type of the person.</li>
</ul>
</div><div class="column" style="width:58%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/MissingValueAnalysis.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="exploratory-data-analysis" class="title-slide slide level1 center">
<h1>Exploratory Data analysis</h1>

</section>
<section id="mean-structure" class="slide level2">
<h2>Mean Structure</h2>

<img data-src="Presentation_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="variance-structure" class="slide level2">
<h2>Variance Structure</h2>

<img data-src="Presentation_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="covariance-structure" class="slide level2">
<h2>Covariance Structure</h2>

<img data-src="Presentation_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch quarto-figure-center"></section></section>
<section>
<section id="find-out-which-covariate-might-influence-the-responses-time-trend" class="title-slide slide level1 center">
<h1>Find out which covariate might influence the responses time trend</h1>

</section>
<section id="spaghetti-plot" class="slide level2">
<h2>Spaghetti plot</h2>
<div class="cell">

</div>
<h3 id="spaghetti-plot-group-by-id">Spaghetti plot group by id</h3>
<div class="cell" data-fig.axis="1">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</div>
</div>
<h3 id="spaghetti-plot-group-by-male">Spaghetti plot group by male</h3>
<div class="cell" data-fig.axis="1">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</div>
</div>
<h3 id="spaghetti-plot-group-by-cardio">Spaghetti plot group by cardio</h3>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</div>
</div>
<h3 id="spaghetti-plot-group-by-reject">Spaghetti plot group by reject</h3>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</div>
</div>
</section>
<section id="boxplot" class="slide level2">
<h2>Boxplot</h2>
<h3 id="box-plot-by-male">Box plot by male</h3>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</div>
</div>
<h3 id="box-plot-by-cardio">Box plot by cardio</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="box-plot-by-reject">Box plot by reject</h3>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-15-1.png" width="960"></p>
</div>
</div>
</section>
<section id="data-set-analysis-to-see-the-age-effect" class="slide level2">
<h2>Data set analysis to see the age effect</h2>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-16-1.png" width="960"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</div>
</div>
</section>
<section id="conclusions-after-exploring-data-analysis" class="slide level2">
<h2>Conclusions after exploring data analysis</h2>
<ul>
<li>The Hc time trend tends to increase first from 0 to 0.5 year then keep variated during the rest of the meassurements</li>
<li>The subject related variables age may increase the mean Hc level of a subject</li>
<li>Male has relative higher Hc level than female</li>
<li>Cardio or reject play no big difference in the Hc level measurements.</li>
</ul>
</section></section>
<section>
<section id="data-analysis" class="title-slide slide level1 center">
<h1>Data analysis</h1>

</section>
<section id="multivariate-data-analysis-using-lm" class="slide level2">
<h2>Multivariate Data Analysis using <code>lm</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Hc <span class="sc">~</span> time, trenal.long)</span>
<span id="cb1-2"><a href="#cb1-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> age, trenal.long)</span>
<span id="cb1-3"><a href="#cb1-3"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> age <span class="sc">+</span> male,trenal.long)</span>
<span id="cb1-4"><a href="#cb1-4"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> age <span class="sc">+</span> male <span class="sc">+</span> reject,trenal.long)</span>
<span id="cb1-5"><a href="#cb1-5"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> age <span class="sc">+</span> male <span class="sc">+</span> reject <span class="sc">+</span> cardio,trenal.long)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">anova</span>(lm1,lm2,lm3,lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Hc ~ time + age
Model 2: Hc ~ time + age + male
Model 3: Hc ~ time + age + male + reject
Model 4: Hc ~ time + age + male + reject + cardio
  Res.Df    RSS Df Sum of Sq        F    Pr(&gt;F)    
1   9548 340135                                    
2   9547 325933  1   14201.6 416.4704 &lt; 2.2e-16 ***
3   9546 325700  1     233.3   6.8405  0.008925 ** 
4   9545 325483  1     216.8   6.3564  0.011712 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="two-stage-model-analysis" class="slide level2">
<h2>Two stage model analysis</h2>
</section>
<section id="linear-mixed-effects-model-analysis-using-lmer" class="slide level2">
<h2>Linear Mixed Effects Model Analysis using <code>lmer</code></h2>
<h3 id="conduct-the-analysis-level-by-level">Conduct the analysis level by level</h3>
<div class="footer">
<p>inspired by Chapter 8 and 9 of <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-lon.html" class="uri">https://bookdown.org/roback/bookdown-BeyondMLR/ch-lon.html</a></p>
</div>
<pre><code>Level One : time and the response variable e.g. Hc level 
Level Two : covariates related to each subject, e.g. age, male, reject, cardio</code></pre>
<p>The trials related to Level One (only time as covariate)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>model.a <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long)</span>
<span id="cb4-2"><a href="#cb4-2"></a>model.b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> (time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span> trenal.long)</span>
<span id="cb4-3"><a href="#cb4-3"></a>model.c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> timec <span class="sc">+</span> <span class="fu">I</span>(timec<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (timec <span class="sc">+</span> <span class="fu">I</span>(timec<span class="sc">^</span><span class="dv">2</span>)<span class="sc">|</span>id),<span class="at">REML=</span>T, <span class="at">data=</span>trenal.long.center)</span>
<span id="cb4-4"><a href="#cb4-4"></a>model.b.piecewise <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2 <span class="sc">+</span> (time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The trials related to level Two (Add subject related variable)</p>
</section>
<section id="unconditional-means-model" class="slide level2 smaller">
<h2>Unconditional Means Model</h2>
<h3 id="to-discover-variance-distribution">— to discover variance distribution</h3>
<p>We can first try the unconditional Means Model to explore the variance( within subject and between-subject), Define <span class="math inline">\(Y_{ij}\)</span> as the Hc level from subject <span class="math inline">\(i\)</span> and measured time <span class="math inline">\(j\)</span></p>
<pre><code>Level One: </code></pre>
<p><span class="math display">\[Y_{ij} = a_i + \epsilon_{ij},\]</span> where <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span> Level Two: <span class="math display">\[a_i = \alpha_0 + u_i,\]</span> where <span class="math inline">\(u_i \sim N(0,\sigma_{u}^2)\)</span></p>
<p>Written in linear mixed effect model is: <span class="math display">\[Y_{ij} = \alpha_0 + u_i + \epsilon_{ij},\]</span> where <span class="math inline">\(u_i \sim N(0,\sigma_u^2)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ 1 + (1 | id)
   Data: trenal.long

REML criterion at convergence: 59106.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.6999 -0.4371  0.1060  0.5631  6.1641 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 13.60    3.688   
 Residual             23.07    4.803   
Number of obs: 9558, groups:  id, 1160

Fixed effects:
            Estimate Std. Error t value
(Intercept)  38.1630     0.1206   316.4</code></pre>
</div>
</div>
<p>From the output of <code>model.a</code>, we obtain estimates of three model parameters:</p>
<ul>
<li><span class="math inline">\(\hat{\alpha}_0 = 38.16\)</span>: the mean of Hc level <span class="math inline">\(\mu_{Hc}\)</span> across all subjects and all years</li>
<li><span class="math inline">\(\hat{\sigma}^2 = 23.07\)</span>: the variance in within-subjects deviation, between years of measurements <span class="math inline">\(Hc_j\)</span> and the mean <span class="math inline">\(\mu_{Hc}\)</span> across all subjects and all years</li>
<li><span class="math inline">\(\hat{\sigma_u}^2 = 13.60\)</span>: the variance in between-subjects deviation, between subject mean <span class="math inline">\(\mu_{Hc_i}\)</span> and the overall mean <span class="math inline">\(\mu_{Hc}\)</span> across all subjects and all years.</li>
</ul>
<p>The intraclass correlation coefficient: <span class="math display">\[\hat{\rho}= \frac{\hat{\sigma_u}^2}{\hat{\sigma_u}^2+\hat{\sigma}^2} = \frac{13.60}{13.60+ 23.07}=0.371\]</span></p>
</section>
<section id="unconditional-growth-model" class="slide level2 smaller">
<h2>Unconditional Growth Model</h2>
<h3 id="introducing-time-in-level-one">— introducing time in Level One</h3>
<pre><code>Level One: </code></pre>
<p><span class="math display">\[Y_{ij} = a_i + b_i \times time_{ij} + \epsilon_{ij},\]</span> where <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<pre><code>Level Two: </code></pre>
<p><span class="math display">\[\begin{align}
     a_i &amp;= \alpha_0 + u_i, \\
     b_i &amp;= \beta_0 + v_i
     \end{align}\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v \\ \rho_{uv} \sigma_u\sigma_v &amp; \sigma_v^2 \end{bmatrix}\right)\)</span></p>
<p>Written in linear mixed effect model is: <span class="math display">\[Y_{ij} = [\alpha_0 + \beta_0 \times time_{ij}] + [ u_i + v_i \times time_{ij} +  \epsilon_{ij} ],\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v \\ \rho_{uv} \sigma_u\sigma_v &amp; \sigma_v^2 \end{bmatrix}\right)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ time + (time | id)
   Data: trenal.long

REML criterion at convergence: 58690.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.2501 -0.4524  0.0685  0.5468  6.4063 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 13.5731  3.6842        
          time         0.1856  0.4308   -0.15
 Residual             20.8883  4.5704        
Number of obs: 9558, groups:  id, 1160

Fixed effects:
            Estimate Std. Error t value
(Intercept) 37.26780    0.13057   285.4
time         0.31583    0.02375    13.3

Correlation of Fixed Effects:
     (Intr)
time -0.394</code></pre>
</div>
</div>
<p>From the <code>model.b</code>, we obtain estimates of our six model parameters:</p>
<ul>
<li><span class="math inline">\(\hat{\alpha}_0 = 37.2678\)</span>: the mean Hc level for the subjects at time 0, <span class="math inline">\(Hc_0\)</span></li>
<li><span class="math inline">\(\hat{\beta}_0 = 0.31583\)</span>: the mean change in successively measurements during totally <span class="math inline">\(12\)</span> measurements</li>
<li><span class="math inline">\(\hat{\sigma}^2 = 20.8883\)</span>: the variance in within-subject deviations</li>
<li><span class="math inline">\(\hat{\sigma}_u^2 = 13.5731\)</span>: the variance between subjects at time 0, <span class="math inline">\(Hc_0\)</span></li>
<li><span class="math inline">\(\hat{\sigma}_v^2 = 0.1856\)</span>: the variance between subjects in rate of changes in Hc level</li>
<li><span class="math inline">\(\rho_{uv} = -0.15\)</span>: the correlation in subject’s <span class="math inline">\(Hc_0\)</span> and the rate of change in Hc level</li>
</ul>
<p>The estimated within-subject variance <span class="math inline">\(\hat{\sigma}^2\)</span> decreased by about <span class="math inline">\(9\%\)</span> from the unconditional means model implying that <span class="math inline">\(9\%\)</span> of within-subject variability in Hc level can be explained by a linear increase over time: <span class="math display">\[Pseudo R^2_{L1} = \frac{\hat{\sigma}^2(uncond. means)-\hat{\sigma}^2(uncond. growth)}{\hat{\sigma}^2(uncond. growth)} = \frac{23.07-20.8883}{23.07} = 0.0948\]</span></p>
</section>
<section id="quadratic-time-trend-modeling" class="slide level2 smaller">
<h2>Quadratic time trend modeling</h2>
<pre><code>Level One: </code></pre>
<p><span class="math display">\[Y_{ij} = a_i + b_i \times time_{ij} + c_i \times time_{ij}^2 + \epsilon_{ij},\]</span> where <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<pre><code>Level Two: </code></pre>
<p><span class="math display">\[\begin{align}
     a_i &amp;= \alpha_0 + u_i, \\
     b_i &amp;= \beta_0 + v_i, \\
     c_i &amp;= \gamma_0 + w_i,
     \end{align}\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \\w_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \\0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v &amp; \rho_{uw} \sigma_u \sigma_w \\ &amp; \sigma_v^2 &amp; \rho_{vw} \sigma_v\sigma_w \\ &amp; &amp; \sigma_w^2 \end{bmatrix}\right)\)</span></p>
<p>Written in linear mixed effect model is: <span class="math display">\[Y_{ij} = [\alpha_0 + \beta_0 \times time_{ij} + \gamma_0 \times time_{ij}^2] + [ u_i + v_i \times time_{ij} + w_i \times time_{ij}^2 +  \epsilon_{ij} ],\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \\w_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \\0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v &amp; \rho_{uw} \sigma_u \sigma_w \\ &amp; \sigma_v^2 &amp; \rho_{vw} \sigma_v\sigma_w \\ &amp; &amp; \sigma_w^2 \end{bmatrix}\right)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ timec + I(timec^2) + (timec + I(timec^2) | id)
   Data: trenal.long.center

REML criterion at convergence: 57865.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.7256 -0.4767  0.0361  0.5308  6.7119 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr       
 id       (Intercept) 21.436916 4.63000             
          timec        0.197651 0.44458   0.27      
          I(timec^2)   0.007685 0.08767  -0.82 -0.44
 Residual             18.231536 4.26984             
Number of obs: 9558, groups:  id, 1160

Fixed effects:
             Estimate Std. Error t value
(Intercept) 40.201415   0.162783 246.963
timec        0.055012   0.024108   2.282
I(timec^2)  -0.161860   0.006341 -25.526

Correlation of Fixed Effects:
           (Intr) timec 
timec       0.244       
I(timec^2) -0.590  0.198
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.0353379 (tol = 0.002, component 1)
Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
</div>
</section>
<section id="piecewise-linear-time-trend" class="slide level2 smaller">
<h2>Piecewise linear time trend</h2>
<p>In the <strong>piecewise linear model</strong>, the complete time span of the study is divided into two segments, with a separate slope relating time to the response in each segment.</p>
<pre><code>Level One: </code></pre>
<p><span class="math display">\[Y_{ij} = a_i + b_i \times time_{1_{ij}} + c_i \times time_{2_{ij}} + \epsilon_{ij},\]</span> where <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<ul>
<li>Level Two:</li>
</ul>
<p><span class="math display">\[\begin{align}
  a_i &amp;= \alpha_0 + u_i, \\
  b_i &amp;= \beta_0 + v_i, \\
  c_i &amp;= \gamma_0 + w_i,
  \end{align}\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \\w_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \\0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v &amp; \rho_{uw} \sigma_u \sigma_w \\ &amp; \sigma_v^2 &amp; \rho_{vw} \sigma_v\sigma_w \\ &amp; &amp; \sigma_w^2 \end{bmatrix}\right)\)</span></p>
<p>Written in linear mixed effect model is: <span class="math display">\[Y_{ij} = [\alpha_0 + \beta_0 \times time_{1_{ij}} + \gamma_0 \times time_{2_{ij}}] + [ u_i + v_i \times time_{1_{ij}} + w_i \times time_{2_{ij}} +  \epsilon_{ij} ],\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \\w_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \\0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v &amp; \rho_{uw} \sigma_u \sigma_w \\ &amp; \sigma_v^2 &amp; \rho_{vw} \sigma_v\sigma_w \\ &amp; &amp; \sigma_w^2 \end{bmatrix}\right)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<p>In our case study, we can fit separate slope in time <span class="math inline">\(0-0.5\)</span> and <span class="math inline">\(0.5-10\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ time1 + time2 + (time2 | id)
   Data: trenal.long.piecewise

REML criterion at convergence: 58545.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.1940 -0.4729  0.0625  0.5607  6.5532 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 13.6532  3.6950        
          time2        0.1867  0.4321   -0.15
 Residual             20.4690  4.5243        
Number of obs: 9558, groups:  id, 1160

Fixed effects:
            Estimate Std. Error t value
(Intercept) 36.76665    0.13678  268.79
time1        4.12291    0.31360   13.15
time2        0.40031    0.02467   16.22

Correlation of Fixed Effects:
      (Intr) time1 
time1 -0.324       
time2 -0.439  0.330</code></pre>
</div>
</div>
</section>
<section id="comparing-the-level-one-models" class="slide level2">
<h2>Comparing the level one models</h2>
<p>Comparing the AIC/ BIC value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>model.a <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long)</span>
<span id="cb15-2"><a href="#cb15-2"></a>model.b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> (time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span> trenal.long)</span>
<span id="cb15-3"><a href="#cb15-3"></a>model.c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> timec <span class="sc">+</span> <span class="fu">I</span>(timec<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (timec <span class="sc">+</span> <span class="fu">I</span>(timec<span class="sc">^</span><span class="dv">2</span>)<span class="sc">|</span>id),<span class="at">REML=</span>T, <span class="at">data=</span>trenal.long.center)</span>
<span id="cb15-4"><a href="#cb15-4"></a>model.b.piecewise <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2 <span class="sc">+</span> (time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>model.a: AIC =  59112.68 ;BIC =  59134.18 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b: AIC =  58702.37 ;BIC =  58745.36 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.c: AIC =  57885.46 ;BIC =  57957.11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise: AIC =  58559.93 ;BIC =  58610.09 </code></pre>
</div>
</div>
<p><code>model.c</code> has the lowest AIC BIC value. But we keep the linear time trend with piecewise time intervals, considering that in real case the Hc level (the percentage of red blood cells in the body) will be affected more by health status than the age of a person.</p>
<p>Besides, the quadratic model seems not really identifiable</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ timec + I(timec^2) + (timec + I(timec^2) | id)
   Data: trenal.long.center

REML criterion at convergence: 57865.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.7256 -0.4767  0.0361  0.5308  6.7119 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr       
 id       (Intercept) 21.436916 4.63000             
          timec        0.197651 0.44458   0.27      
          I(timec^2)   0.007685 0.08767  -0.82 -0.44
 Residual             18.231536 4.26984             
Number of obs: 9558, groups:  id, 1160

Fixed effects:
             Estimate Std. Error t value
(Intercept) 40.201415   0.162783 246.963
timec        0.055012   0.024108   2.282
I(timec^2)  -0.161860   0.006341 -25.526

Correlation of Fixed Effects:
           (Intr) timec 
timec       0.244       
I(timec^2) -0.590  0.198
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.0353379 (tol = 0.002, component 1)
Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ time1 + time2 + (time2 | id)
   Data: trenal.long.piecewise

REML criterion at convergence: 58545.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.1940 -0.4729  0.0625  0.5607  6.5532 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 13.6532  3.6950        
          time2        0.1867  0.4321   -0.15
 Residual             20.4690  4.5243        
Number of obs: 9558, groups:  id, 1160

Fixed effects:
            Estimate Std. Error t value
(Intercept) 36.76665    0.13678  268.79
time1        4.12291    0.31360   13.15
time2        0.40031    0.02467   16.22

Correlation of Fixed Effects:
      (Intr) time1 
time1 -0.324       
time2 -0.439  0.330</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="adding-subject-related-variable-in-level-two" class="slide level2">
<h2>Adding subject related variable in level two</h2>
<h3 id="based-on-the-model.b">Based on the <code>model.b</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>model.b.age <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time  <span class="sc">+</span> age <span class="sc">+</span> (time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.scaled)</span>
<span id="cb22-2"><a href="#cb22-2"></a>model.b.male <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time <span class="sc">+</span> male <span class="sc">+</span> (time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.scaled)</span>
<span id="cb22-3"><a href="#cb22-3"></a>model.b.agemale <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time  <span class="sc">+</span>male <span class="sc">+</span> age <span class="sc">+</span>(time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.scaled)</span>
<span id="cb22-4"><a href="#cb22-4"></a>model.b.agemalereject <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time  <span class="sc">+</span>age <span class="sc">+</span> male<span class="sc">+</span> reject <span class="sc">+</span>(time<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>model.b: AIC =  58702.37 ;BIC =  58745.36 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.age: AIC =  58625.59 ;BIC =  58675.74 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.male: AIC =  58606.56 ;BIC =  58656.71 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.agemale: AIC =  58527.24 ;BIC =  58584.55 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.agemalereject: AIC =  58527.94 ;BIC =  58592.42 </code></pre>
</div>
</div>
</section>
<section id="final-chosen-model" class="slide level2">
<h2>Final chosen model</h2>
<p>Our chosen model would be the linear model with age gender as the level two variables <code>model.b.agemale</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ time + male + age + (time | id)
   Data: trenal.long.scaled

REML criterion at convergence: 58511.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.2238 -0.4568  0.0729  0.5568  6.4306 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 11.9573  3.4579        
          time         0.1864  0.4317   -0.21
 Residual             20.8875  4.5703        
Number of obs: 9551, groups:  id, 1159

Fixed effects:
             Estimate Std. Error t value
(Intercept) 33.195249   0.433448  76.584
time         0.322553   0.023698  13.611
male1        2.350432   0.227837  10.316
age          0.058657   0.008504   6.897

Correlation of Fixed Effects:
      (Intr) time   male1 
time  -0.162              
male1 -0.292  0.011       
age   -0.909  0.037 -0.011
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00413353 (tol = 0.002, component 1)</code></pre>
</div>
</div>
</section>
<section id="adding-subject-related-variable-in-level-two-1" class="slide level2">
<h2>Adding subject related variable in level two</h2>
<h3 id="based-on-the-model.b.piecewise">Based on the <code>model.b.piecewise</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>model.b.piecewise.age <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2 <span class="sc">+</span> age <span class="sc">+</span> (time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span>
<span id="cb29-2"><a href="#cb29-2"></a>model.b.piecewise.male <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2 <span class="sc">+</span> male <span class="sc">+</span> (time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span>
<span id="cb29-3"><a href="#cb29-3"></a>model.b.piecewise.agemale <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2  <span class="sc">+</span>male <span class="sc">+</span> age <span class="sc">+</span>(time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span>
<span id="cb29-4"><a href="#cb29-4"></a>model.b.piecewise.agemalereject <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Hc <span class="sc">~</span> time1 <span class="sc">+</span> time2  <span class="sc">+</span>age <span class="sc">+</span> male<span class="sc">+</span> reject <span class="sc">+</span>(time2<span class="sc">|</span>id),<span class="at">REML=</span>T,<span class="at">data=</span>trenal.long.piecewise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise: AIC =  58559.93 ;BIC =  58610.09 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise.age: AIC =  58483.85 ;BIC =  58541.16 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise.male: AIC =  58464.65 ;BIC =  58521.97 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise.agemale: AIC =  58386 ;BIC =  58450.48 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>model.b.piecewise.agemalereject: AIC =  58386.74 ;BIC =  58458.38 </code></pre>
</div>
</div>
</section>
<section id="final-chosen-model-1" class="slide level2">
<h2>Final chosen model</h2>
<p>Our chosen model would be the piecewise linear model with age gender as the level two variables <code>model.b.piecewise.agemale</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Hc ~ time1 + time2 + male + age + (time2 | id)
   Data: trenal.long.piecewise

REML criterion at convergence: 58368

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.1683 -0.4680  0.0637  0.5619  6.5758 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 12.0382  3.4696        
          time2        0.1874  0.4329   -0.21
 Residual             20.4704  4.5244        
Number of obs: 9551, groups:  id, 1159

Fixed effects:
             Estimate Std. Error t value
(Intercept) 32.694557   0.435712  75.037
time1        4.112153   0.313713  13.108
time2        0.406601   0.024616  16.518
male1        2.346642   0.228052  10.290
age          0.058747   0.008512   6.902

Correlation of Fixed Effects:
      (Intr) time1  time2  male1 
time1 -0.104                     
time2 -0.180  0.331              
male1 -0.290 -0.001  0.011       
age   -0.905  0.003  0.035 -0.011
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00794242 (tol = 0.002, component 1)</code></pre>
</div>
</div>
<p><span class="math display">\[Y_{ij} = [32.69 + 4.112\times time_{1_{ij}} +0.4066 \times time_{2_{ij}} + 2.347 \times male_i + 0.058747 \times age_i] + [u_i + v_i \times time_{2_{ij}}+ \epsilon_{ij} \]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix}12.038 &amp; -0.3155271 \\ -0.3155271 &amp; 0.1874\end{bmatrix}\right)\)</span>,and <span class="math inline">\(\epsilon_{ij} \sim N(0,20.47)\)</span></p>
</section></section>
<section>
<section id="two-stage-model-analysis-comparison" class="title-slide slide level1 center">
<h1>Two Stage Model Analysis comparison</h1>

</section>
<section id="two-stage-model" class="slide level2">
<h2>Two stage Model</h2>
<h3 id="stage-one">Stage one</h3>

<img data-src="Presentation_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"><h3 id="stage-two">Stage two</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  id age male cardio reject Hc time  a  b
1  1  25    1      0      1 26  0.0 NA NA
2  1  25    1      0      1 41  0.5 NA NA
3  1  25    1      0      1 42  1.0 NA NA
4  1  25    1      0      1 44  2.0 NA NA
5  1  25    1      0      1 44  3.0 NA NA
6  1  25    1      0      1 45  4.0 NA NA</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = a ~ age + male, data = ab)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.2780  -3.0676  -0.3379   2.7342  11.9830 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 32.89757    0.25989  126.58   &lt;2e-16 ***
age          0.06970    0.00562   12.40   &lt;2e-16 ***
male1        2.57660    0.13688   18.82   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.35 on 4065 degrees of freedom
  (9852 observations deleted due to missingness)
Multiple R-squared:  0.1042,    Adjusted R-squared:  0.1037 
F-statistic: 236.4 on 2 and 4065 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %    97.5 %
(Intercept) 32.38805063 33.407089
age          0.05867982  0.080715
male1        2.30824792  2.844960</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = b ~ age + male, data = ab)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.07184 -0.35816 -0.00676  0.39026  1.70238 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.3264235  0.0337790   9.663  &lt; 2e-16 ***
age         -0.0005096  0.0007304  -0.698    0.485    
male1       -0.0710852  0.0177909  -3.996 6.57e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5654 on 4065 degrees of freedom
  (9852 observations deleted due to missingness)
Multiple R-squared:  0.003945,  Adjusted R-squared:  0.003455 
F-statistic:  8.05 on 2 and 4065 DF,  p-value: 0.0003241</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %       97.5 %
(Intercept)  0.260198135  0.392648915
age         -0.001941644  0.000922405
male1       -0.105965108 -0.036205358</code></pre>
</div>
</div>
</section>
<section id="the-equivalent-lmm-model-should-be" class="slide level2">
<h2>The equivalent LMM model should be</h2>
<pre><code>Level One: </code></pre>
<p><span class="math display">\[Y_{ij} = a_i + b_i \times time_{ij} + \epsilon_{ij},\]</span> where <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<pre><code>Level Two: </code></pre>
<p><span class="math display">\[\begin{align}
     a_i &amp;= \alpha_0 + \alpha_1 \times age_i + \alpha_2 \times male_i +  u_i, \\
     b_i &amp;= \beta_0 + \beta_1 \times age_i + \beta_2 \times male_i + v_i
     \end{align}\]</span> where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v \\ \rho_{uv} \sigma_u\sigma_v &amp; \sigma_v^2 \end{bmatrix}\right)\)</span></p>
<p>The equivalent linear mixed effect model is: <span class="math display">\[Y_{ij} = [\alpha_0 + \alpha_1 \times age_i +  \alpha_2 \times male_i + \beta_0 \times time_{ij} +\beta_1 \times age_i \times time_{ij} +\beta_2 \times male_i \times time_{ij} ] + [ u_i + v_i \times time_{ij} +  \epsilon_{ij} ],\]</span></p>
<p>where <span class="math inline">\(\begin{bmatrix} u_i \\ v_i \end{bmatrix} \sim N\left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix}\sigma_{u}^2 &amp; \rho_{uv}\sigma_u\sigma_v \\ \rho_{uv} \sigma_u\sigma_v &amp; \sigma_v^2 \end{bmatrix}\right)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0,\sigma^2)\)</span></p>
<div class="cell">

</div>
</section>
<section id="result-comparison" class="slide level2">
<h2>Result comparison</h2>
<div class="cell">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">coefficients.name</th>
<th style="text-align: left;">coeff.twostage</th>
<th style="text-align: left;">coeff.LMM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">alpha_0</td>
<td style="text-align: left;">32.8975699323574</td>
<td style="text-align: left;">33.6673837336226</td>
</tr>
<tr class="even">
<td style="text-align: left;">alpha_1</td>
<td style="text-align: left;">0.0696974136630805</td>
<td style="text-align: left;">0.0498091192428494</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alpha_2</td>
<td style="text-align: left;">2.576603751364</td>
<td style="text-align: left;">2.22085177214344</td>
</tr>
<tr class="even">
<td style="text-align: left;">beta_0</td>
<td style="text-align: left;">0.326423524902391</td>
<td style="text-align: left;">0.112273787474164</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta_1</td>
<td style="text-align: left;">-0.000509619578403424</td>
<td style="text-align: left;">0.00404103830321673</td>
</tr>
<tr class="even">
<td style="text-align: left;">beta_2</td>
<td style="text-align: left;">-0.0710852331532519</td>
<td style="text-align: left;">0.0579677566050636</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>